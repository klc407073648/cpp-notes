# 分段和分页

* 分段：
	* 概念：将一段与程序所需内存空间大小的虚拟空间映射到某个地址空间
	* 出发点：从用户和程序员的角度提出，满足方便编程，信息保护和共享，动态增长及动态链等多方面的需要。
	* 优点：没有内碎片，外碎片可以通过内存紧缩来消除；便于实现内存共享。
	* 缺点：进程必须全部装入内存。
* 分页：
	* 概念：把地址空间人为地等分成固定大小的页，通常为4KB大小。
	* 出发点：从计算机角度考虑设计的，目的是为了内存的利用率，提高计算机性能，分页通过硬件机制实现，对用户完全透明
	* 优点：没有外碎片,每个内碎片不超过每页的大小(4K);
	* 缺点：要求程序全部载入内存,没有足够的内存,程序不能执行。

## 分段分页算法

在分段分页算法中，每个段都可以独立地加载到内存中。但是，由于内存空间有限，操作系统通常只将进程的部分段加载到内存中，而将其他段存储在辅存（如硬盘）中。

通常情况下，操作系统将常用的**代码段和数据段加载到内存中**，以便进程能够快速执行和访问这些数据。而对于不常用的段，操作系统可以**按需进行加载**，即在进程访问这些段时再将其加载到内存中。

这种按需加载的方式可以节省内存空间，并且在进程运行时减少了初始化和加载的时间。当进程需要访问未加载到内存中的段时，会触发缺段（Segment Fault），操作系统根据需要从辅存中加载相应的段到内存中，然后继续执行进程的指令。

分段分页算法：在分段分页算法中，进程的地址空间被划分为多个段，每个段表示不同的逻辑数据单元（如代码段、数据段等）。每个段再被划分为相等大小的页，称为页框。这样就形成了一个段表和一个页表，用于映射逻辑地址到物理地址。

当一个进程需要访问一个逻辑地址时，分段分页算法首先通过段表找到对应的段表项，然后再通过页表找到对应的页表项，最后计算出物理地址。如果某个页面不在主存中，即缺页（Page Fault），则会触发页面置换算法。

页面置换算法：页面置换算法用于在主存空间不足时，选择合适的页面将其置换（调出）到辅存（磁盘或其他存储介质），从而腾出空间来加载新的页面。

常见的页面置换算法包括最佳置换算法（OPT），最近最久未使用算法（LRU），先进先出算法（FIFO）等。这些算法根据页面的访问情况、历史记录等来决定哪个页面最有可能被未来访问，然后将最不可能被访问的页面置换出去。

选择适合的页面置换算法，可以尽可能降低缺页率，提高内存利用率。同时，页面置换算法的选择也会受到硬件条件和系统需求的限制。