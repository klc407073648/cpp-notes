# C++ Tips - 前向声明（forward declaration）

> 本文讲解C++前向声明的含义。

[[toc]]

前向声明: `可以声明一个类而不定义它。这个声明被称为前向声明(forward declaration)。`
* 例如: class name，在声明之后，定义之前，类name是一个不完全类型(incompete type)，即已知name是一个类型，但不知道包含哪些成员。不完全类型只能以`有限方式使用，不能定义该类型的对象，不完全类型只能用于定义指向该类型的指针及引用，或者用于声明(而不是定义)使用该类型作为形参类型或返回类型的函数`。类的前向声明`只适用于指针和引用的定义`，如果是普通类的类型就得使用include了。 

下面来介绍两个类之间的相互引用包含问题，以及如何使用前向声明解决这个问题。   

例1: 类A，类B相互引用定义对象，会导致编译报错，因为存在a.b.a.b.a.b.a.b...，陷入死循环。

```cpp
class A
{
    int i;
    B b;
}
class B
{
     int i;
     A a;
}
```

例2: 定义时，相互引用肯定会需要相互包含头文档，但仅仅只是在各自的头文档中包含对方的头文档，是不能通过编译的。如上的包含方式可能会造成编译器有错误提示: A.h文档中使用了未知类型B。

```cpp
//class A.h
#include "B.h"
class A
{
     int i;
     B b;
}
//class B.h
#include "A.h"
class B
{
    int i;
    A *a;
}
```

例3: 两个类的头文档之中，选一个包含另一个类的头文档，但另一个头文件中只能采用class *的申明形式，而在实现文档中（*.cpp）中包含头文件。

```cpp
//class A.h
#include "B.h"
class A
{
     int i;
     B b;
}
//class B.h
class A;
class B
{
    int i;
    A *a;
}
//B.cpp
//在B.cpp中的文档包含处要有下面语句，否则不能调用成员a的任何内容
#include "A.h"
B::B()
{
    ……
}
```

当两个类互相包含，且互相在本类中定义另外一个类的对象指针引用时，必须保证当一个类先声明或者定义时才可以在另外一个类中使用。