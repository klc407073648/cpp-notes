# IP地址详解

[[toc]]

[IP地址和子网划分学习笔记之《IP地址详解》](https://blog.csdn.net/weixin_34234823/article/details/92963760)

# 分类的IP地址

## 概述

IP 地址是给每个连接在因特网上的主机（或路由器）分配一个在全世界范围是惟一的32 bit的标识符。

IP 地址现在由因特网名字与号码指派机构ICANN (Internet Corporation for Assigned Names and Numbers)进行分配。

IP地址的编址经历三个历史阶段

1. 分类的IP地址。 ———— 最基本的编址方法
2. 子网的划分。   ———— 对最基本的编址方法的改进
3. 构成超网。     ———— 新的无分类编址方法

## 分类IP地址

> 本文只讨论最基本的分类IP地址

所谓“分类的IP地址”就是将IP地址划分为**若干个固定类**，每一类地址都由俩个固定长度的字段组成。

* **网络号(net-id)**：它标志着主机(或路由器)所连接到的网络。一个网络号在整个互联网范围内必须是唯一的。
* **主机号(host-id)**：一台主机号在它前面的网络号所指明的网络范围内必须是唯一的。因此一个IP地址在整个互联网范围内都是唯一的。

`IP地址 ::= {<网络号>,<主机号>}`

## IP地址分类

IP地址分A、B、C、D、E五类，其中A、B、C这三类是比较常用的IP地址，D、E类为特殊地址。

![1](/_images/interview/ip-address/IP地址分类.png)

**A类地址**

* A类地址第1字节为网络地址（最高位固定是0），另外3个字节为主机地址。
* A类地址范围：1.0.0.0 - 126.255.255.255，其中0和127作为特殊地址。
* A类网络**默认子网掩码为255.0.0.0，也可写作/8**。
* A类网络最大主机数量是256×256×256-2=166777214（减去1个主机位为0的网络地址和1个广播地址）。

在计算机网络中，**主机ID全部为0的地址为网络地址，而主机ID全部为1的地址为广播地址，这2个地址是不能分配给主机用的。**

**B类地址**

* B类地址第1字节（最高位固定是10）和第2字节为网络地址，另外2个字节为主机地址。
* B类地址范围：128.0.0.0 - 191.255.255.255。
* B类网络默认子网掩码为255.255.0.0，也可写作/16。
* B类网络最大主机数量256×256-2=6554。

**C类地址**

* C类地址第1字节（最高位固定是110）、第2字节和第3个字节，另外1个字节为主机地址。
* C类地址范围：192.0.0.0 - 223.255.255.255。
* C类网络默认子网掩码为255.255.255.0，也可写作/24。
* C类网络最大主机数量256-2=254。

**D类地址**

* D类地址不分网络地址和主机地址，它的第1个字节的最高位固定是1110。
* D类地址用于组播（也称为多播）的地址，无子网掩码。
* D类地址范围：224.0.0.0 - 239.255.255.255。

**E类地址**

* E类地址也不分网络地址和主机地址，它的第1个字节的最高位固定是11110。
* E类地址范围：240.0.0.0 - 255.255.255.255。

其中240.0.0.0-255.255.255.254作为保留地址，主要用于Internet试验和开发，255.255.255.255作为广播地址。

画出思维导图进行总结：

![1](/_images/interview/ip-address/IP地址分类脑图.png)

## 保留的特殊IP地址

以下这些特殊IP地址都是不能分配给主机用的地址：

- **主机ID全为0的地址**：特指某个网段，比如：192.168.10.0 255.255.255.0，指192.168.10.0网段。
- **主机ID全为1的地址**：特指该网段的全部主机，比如：192.168.10.255，如果你的计算机发送数据包使用主机ID全是1的IP地址，数据链层地址用广播地址FF-FF-FF-FF-FF-FF。
- 127.0.0.1：是本地环回地址，指本机地址，一般用来测试使用。回送地址(127.x.x.x)是本机回送地址(Loopback Address)，即主机IP堆栈内部的IP地址。
- 169.254.0.0：169.254.0.0-169.254.255.255实际上是自动私有IP地址。
- 0.0.0.0：如果计算机的IP地址和网络中的其他计算机地址冲突，使用ipconfig命令看到的就是0.0.0.0，子网掩码也是0.0.0.0。

保留的特殊IP地址思维导图如下：

![1](/_images/interview/ip-address/保留的特殊IP地址.png)

## 公网和私网IP地址

公网IP地址

> 公有地址分配和管理由Inter NIC（Internet Network Information Center 因特网信息中心）负责。各级ISP使用的公网地址都需要向Inter NIC提出申请，有Inter NIC统一发放，这样就能确保地址块不冲突。

私网IP地址

> 创建IP寻址方案的人也创建了**私网IP地址**。这些地址可以被用于私有网络，在Internet没有这些IP地址，Internet上的路由器也没有到私有网络的路由表。

- A类：**10**.0.0.0～**10**.255.255.255 掩码 255.0.0.0，保留了1个A类网络。
- B类：**172.16**.0.0～**172.31**.255.255 掩码 255.255.0.0，保留了16个B类网络。
- C类：**192.168.0**.0～**192.168.255**.255 掩码 255.255.255.0，保留了256个C类网络。

PS：私网地址访问Internet需要做NAT或PAT网络地址转换

![1](/_images/interview/ip-address/私网地址访问Internet.png)

公网和私网IP地址思维导图如下：

![1](/_images/interview/ip-address/公网和私网IP.png)

## IP地址与MAC地址

**IP地址与MAC地址区别**

- 长度不同：IP地址为32位（二进制），MAC地址为48位（十六进制）。
- 分配依据不同：IP地址的分配是基于网络拓扑，MAC地址的分配是基于制造商。
- 寻址协议层不同：IP地址应用于OSI第三层（网络层），而MAC地址应用在OSI第二层（数据链路层）。

**IP地址与MAC地址的作用和关系**

IP和MAC两者之间分工明确，默契合作，完成通信过程。在数据通信时，IP地址专注于网络层，网络层设备（如路由器）根据IP地址，将数据包从一个网络传递转发到另外一个网络上；而MAC地址专注于数据链路层，数据链路层设备（如交换机）根据MAC地址，将一个数据帧从一个节点传送到相同链路的另一个节点上。IP和MAC地址这种映射关系由**ARP（Address Resolution Protocol，地址解析协议）协议完成**，ARP根据目的IP地址，找到中间节点的MAC地址，通过中间节点传送，从而最终到达目的网络。

## IP地址和子网掩码

### 子网掩码计算

有一个C类地址为: 192.9.200.13　其缺省的子网掩码为: 255.255.255.0

IP地址 192.9.200.13， 转换为二进制11000000　00001001　11001000　00001101

子网掩码255.255.255.0，转换为二进制11111111　11111111　11111111　00000000

网络号计算方法： 将两个二进制数做按位与（&）运算后得出的结果即为网络号，即网络号为192.9.200.0

主机号计算方法：将子网掩码取反再与IP地址按位与（&）后得到的结果即为主机号，即主机号为13(或者0.0.0.13)

## IPv4与IPv6地址格式

### IPv4地址

> IPv4地址长32位，采用点分十进制表示，四段八位二进制数。

A类：A类地址范围：1.0.0.0 - 126.255.255.255

### IPv6地址

> IPv6地址有3种格式：首选格式、压缩表示和内嵌IPv4地址的IPv6地址表示。

**首选格式**

IPv6的地址长度是128位（bit），将这128位的地址按每16位划分为一个段，将每个段转换成十六进制数字，并用冒号隔开。

`2000:0000:0000:0000:0001:2345:6789:abcd`

**压缩表示**

如果一个以冒号十六进制数表示法表示的IPv6地址中，如果几个连续的段值都是0，那么这些0可以简记为::。**每个地址中只能有一个::**。

`2001:DB8:0:0:8:800:200C:417A`

可以压缩为：

`2001:DB8::8:800:200C:417A`

**内嵌IPv4地址的IPv6地址表示**

在这种表示方法中，IPv6地址的第一部分使用十六进制表示，而IPv4地址部分是十进制格式：

有两种内嵌IPv4地址的IPv6地址表示：

IPv4兼容IPv6地址： 0:0:0:0:0:0192.168.1.2

IPv4映射IPv6地址： 0:0:0:0:0FFFF:192.168.1.2或::FFFF:192.168.1.2
